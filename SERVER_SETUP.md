# 服務器設置說明

## 文件上傳功能

本應用現在支持將用戶上傳的圖片保存到服務器的文件系統中。

## 安裝依賴

首先安裝新增的依賴：

```bash
npm install
```

新增的依賴包括：
- `express` - Web 服務器框架
- `multer` - 文件上傳中間件
- `cors` - 跨域支持
- `concurrently` - 同時運行多個命令

## 運行方式

### 方式 1：同時運行前端和後端（推薦）

```bash
npm run dev
```

這會同時啟動：
- 後端服務器：`http://localhost:3000`
- 前端開發服務器：`http://localhost:7575`

### 方式 2：分別運行

**終端 1 - 啟動後端服務器：**
```bash
npm run server
```

**終端 2 - 啟動前端開發服務器：**
```bash
npm start
```

## 文件存儲位置

上傳的圖片會保存在：
```
public/uploads/
```

服務器會自動創建這個文件夾（如果不存在）。

## API 端點

- `POST /api/upload` - 上傳圖片
- `GET /api/images` - 獲取所有上傳的圖片列表
- `GET /uploads/:filename` - 訪問上傳的圖片

## 注意事項

1. **文件大小限制**：單個文件最大 10MB
2. **文件類型**：只允許圖片文件（image/*）
3. **文件命名**：服務器會自動生成唯一文件名（時間戳 + 隨機數 + 擴展名），不包含原始文件名以避免中文檔名問題
4. **持久化存儲**：圖片保存在 `public/uploads/` 文件夾中，即使重啟服務器也不會丟失
5. **歷史記錄**：應用會從服務器加載所有已上傳的圖片，並在刷新頁面後自動恢復

## 生產環境部署

在生產環境中，請確保：
1. 修改 `src/environments/environment.prod.ts` 中的 `apiUrl` 為實際的服務器地址
2. 確保 `public/uploads/` 文件夾有寫入權限
3. 考慮使用環境變量來配置 API URL

